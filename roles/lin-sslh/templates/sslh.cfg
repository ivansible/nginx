verbose: {{ sslh_verbose | bool | ternary('true','false') }};
foreground: true;
transparent: {{ sslh_transparent | bool | ternary('true','false') }};
{% if sslh_ssh_port %}
timeout: {{ sslh_ssh_timeout }};
on-timeout: "ssh";
{% endif %}
user: "sslh";
pidfile: "/run/sslh/sslh.pid";
listen:
(
{% for addr in sslh_listen_addresses | select | sort |unique %}
  { host: "{{ addr }}"; port: "443"; }{% if not loop.last %},{% endif %}

{% endfor %}
);
protocols:
(
{% if sslh_ssh_port %}
  { name: "ssh"; host: "localhost4or6"; port: "{{ sslh_ssh_port }}"; probe: "builtin"; fork: true; },
{% endif %}
{% if sslh_openvpn_port %}
  { name: "openvpn"; host: "localhost4or6"; port: "{{ sslh_openvpn_port }}"; probe: "builtin"; },
{% endif %}
  { name: "tls"; host: "localhost4or6"; port: "443"; probe: "builtin"; },
  { name: "anyprot"; host: "localhost4or6"; port: "443"; probe: "builtin"; }
);
